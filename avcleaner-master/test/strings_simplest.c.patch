//
// Created by vladimir on 28.09.19.
//

#include <Windows.h>
#include <stdio.h>


char  hid_core_l_m2QmRPjifxsI[] = {'\x63','\x6f','\x72','\x65','\x5f','\x6c','\x6f','\x61','\x64','\x6c','\x69','\x62',0};

char  hid_reques_FWGsz07kW0fD[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x6c','\x6f','\x61','\x64','\x6c','\x69','\x62',0};

char  hid_core_e_ARngelP9IweT[] = {'\x63','\x6f','\x72','\x65','\x5f','\x65','\x6e','\x75','\x6d','\x65','\x78','\x74','\x63','\x6d','\x64',0};

char  hid_reques_bGL506V4vNtH[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x65','\x6e','\x75','\x6d','\x65','\x78','\x74','\x63','\x6d','\x64',0};

char  hid_core_m_5tJjq6Jf04qr[] = {'\x63','\x6f','\x72','\x65','\x5f','\x6d','\x61','\x63','\x68','\x69','\x6e','\x65','\x5f','\x69','\x64',0};

char  hid_reques_vNLDSHoBDM6W[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x6d','\x61','\x63','\x68','\x69','\x6e','\x65','\x5f','\x69','\x64',0};

char  hid_core_g_lx9b79lIBYL4[] = {'\x63','\x6f','\x72','\x65','\x5f','\x67','\x65','\x74','\x5f','\x73','\x65','\x73','\x73','\x69','\x6f','\x6e','\x5f','\x67','\x75','\x69','\x64',0};

char  hid_reques_2r1BF23LNtft[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x67','\x65','\x74','\x5f','\x73','\x65','\x73','\x73','\x69','\x6f','\x6e','\x5f','\x67','\x75','\x69','\x64',0};
char *customCommands[] =
{
	hid_core_l_m2QmRPjifxsI,
    hid_reques_FWGsz07kW0fD,
	hid_core_e_ARngelP9IweT,
    hid_reques_bGL506V4vNtH,
	hid_core_m_5tJjq6Jf04qr,
    hid_reques_vNLDSHoBDM6W,
	hid_core_g_lx9b79lIBYL4,
    hid_reques_2r1BF23LNtft
};

typedef NTSTATUS (NTAPI *f_NtMapViewOfSection)(HANDLE, HANDLE, PVOID *, ULONG, ULONG,
PLARGE_INTEGER, PULONG, ULONG, ULONG, ULONG);
typedef NTSTATUS (* PKUHL_M_C_FUNC) (int argc, wchar_t * args[]);
typedef NTSTATUS (* PKUHL_M_C_FUNC_INIT) ();

typedef struct _KUHL_M_C {
    const PKUHL_M_C_FUNC pCommand;
    const wchar_t * command;
    const wchar_t * description;
} KUHL_M_C, *PKUHL_M_C;

int main(void)
{

    f_NtMapViewOfSection lNtMapViewOfSection;
    HMODULE ntdll;

    
	char  hid_____At_XhlwAXKXcF8Y[] = {'\x5b','\x2a','\x5d','\x20','\x41','\x74','\x74','\x65','\x6d','\x70','\x74','\x69','\x6e','\x67','\x20','\x74','\x6f','\x20','\x61','\x64','\x64','\x20','\x75','\x73','\x65','\x72','\x20','\x25','\x73','\x20','\x74','\x6f','\x20','\x68','\x6f','\x73','\x74','\x20','\x25','\x73','\n',0};

	char  hid_userna_CF7tXiC51Cup[] = {'\x75','\x73','\x65','\x72','\x6e','\x61','\x6d','\x65',0};

	char  hid_dc_net_Y8liH34adJ9U[] = {'\x64','\x63','\x5f','\x6e','\x65','\x74','\x62','\x69','\x6f','\x73','\x5f','\x6e','\x61','\x6d','\x65',0};
if (!(ntdll = LoadLibrary(TEXT("ntdll"))))
    {
        return -1;
    }

    lNtMapViewOfSection = (f_NtMapViewOfSection)GetProcAddress(ntdll, "NtMapViewOfSection");
    lNtMapViewOfSection(0,0,0,0,0,0,0,0,0,0);

    char return_value[500];
    sprintf(return_value, hid_____At_XhlwAXKXcF8Y, hid_userna_CF7tXiC51Cup, hid_dc_net_Y8liH34adJ9U);
    return 0;
}